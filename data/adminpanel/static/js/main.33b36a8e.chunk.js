(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{170:function(e,t,n){e.exports={wrapper:"LoadingComponent_wrapper__WTtdA",label:"LoadingComponent_label__KWaQ5"}},217:function(e,t,n){e.exports={form:"ProductForm_form__2c6Kw"}},218:function(e,t,n){e.exports={app:"App_app__3BmVS"}},388:function(e,t,n){},389:function(e,t,n){"use strict";n.r(t);var r=n(0),c=n(49),a=n.n(c),i=n(39),o=(n(237),n(30)),s=n.n(o),u=n(71),d=n(11),l=n(12),p=n(19),j=n(209),b="https://steelyrat.xyz/api";var h=n.n(j).a.create({baseURL:b}),f=function(e){return new Promise((function(t){setTimeout(t,e)}))};h.interceptors.response.use(function(){var e=Object(u.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f(1e3);case 2:return e.abrupt("return",t);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());var O=function(e){return e.data},x={list:function(e,t){return h.get("/products",{params:{page:e,pageSize:t}}).then(O)},details:function(e){return h.get("/products/".concat(e)).then(O)},create:function(e){return h.post("/products",e)},update:function(e){return h.put("/products/".concat(e.id),e).then(O)},delete:function(e){return h.delete("/products/".concat(e)).then(O)}},g=function(){function e(){var t=this;Object(d.a)(this,e),this.productRegistry=new Map,this.loadingInitial=!1,this.loading=!1,this.amount=0,this.setProduct=function(e){t.productRegistry.set(e.id,e)},this.loadProducts=function(){var e=Object(u.a)(s.a.mark((function e(n,r){var c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.loadingInitial=!0,t.productRegistry.clear(),e.prev=2,e.next=5,x.list(n,r);case 5:c=e.sent,Object(p.g)((function(){t.amount=c.amount,c.data.forEach((function(e){return t.setProduct(e)}))})),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),console.log(e.t0);case 12:return e.prev=12,t.setLoadingInitial(!1),e.finish(12);case 15:case"end":return e.stop()}}),e,null,[[2,9,12,15]])})));return function(t,n){return e.apply(this,arguments)}}(),this.loadProduct=function(){var e=Object(u.a)(s.a.mark((function e(n){var r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.productRegistry.has(n)){e.next=2;break}return e.abrupt("return",t.productRegistry.get(n));case 2:return t.setLoadingInitial(!0),console.log("load product ",t.loadingInitial),e.next=6,x.details(n);case 6:return r=e.sent,t.setLoadingInitial(!1),e.abrupt("return",r);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.createProduct=function(){var e=Object(u.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,x.create(t);case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.log(e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t){return e.apply(this,arguments)}}(),this.updateProduct=function(){var e=Object(u.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,x.update(t);case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.log(e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t){return e.apply(this,arguments)}}(),this.deleteProduct=function(){var e=Object(u.a)(s.a.mark((function e(n){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.setLoading(!0),e.next=4,x.delete(n);case 4:Object(p.g)((function(){t.productRegistry.delete(n),t.amount=t.amount-1})),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:return e.prev=10,t.setLoading(!1),e.finish(10);case 13:case"end":return e.stop()}}),e,null,[[0,7,10,13]])})));return function(t){return e.apply(this,arguments)}}(),this.setLoadingInitial=function(e){t.loadingInitial=e},this.setLoading=function(e){t.loading=e},Object(p.d)(this)}return Object(l.a)(e,[{key:"products",get:function(){return Array.from(this.productRegistry.values())}}]),e}(),m={productStore:new g},v=Object(r.createContext)(m);function w(){return Object(r.useContext)(v)}var y=n(10),P=n(402),k=n(4),C=function(){return Object(k.jsx)("div",{children:"Home Page"})},S=function(){return Object(k.jsx)("div",{children:"Not Found"})},I=n(94),L=n(211),R=n(170),_=n.n(R);var N=function(e){var t=e.label;return Object(k.jsxs)("div",{className:_.a.wrapper,children:[Object(k.jsx)("p",{className:_.a.label,children:t}),Object(k.jsx)(L.PulseLoader,{color:"#2185d0"})]})},T=n(23),H=n(37),q=n(405),z=n(407),A=n(404),E=n(104),F=Object(I.a)((function(e){var t=e.page,n=e.totalPages,c=Object(r.useState)(""),a=Object(H.a)(c,2),o=a[0],s=a[1],u=w().productStore,d=u.products,l=u.loading,p=u.deleteProduct,j=Object(y.f)();return 0===d.length&&j.push("/products"),Object(k.jsxs)(q.a,{celled:!0,children:[Object(k.jsx)(q.a.Header,{children:Object(k.jsxs)(q.a.Row,{children:[Object(k.jsx)(q.a.HeaderCell,{children:"Title"}),Object(k.jsx)(q.a.HeaderCell,{children:"Price"}),Object(k.jsx)(q.a.HeaderCell,{children:"Description"}),Object(k.jsx)(q.a.HeaderCell,{children:"Actions"})]})}),Object(k.jsx)(q.a.Body,{children:d.map((function(e){var t=l&&e.id===o;return Object(k.jsxs)(q.a.Row,{children:[Object(k.jsx)(q.a.Cell,{width:"2",children:e.title}),Object(k.jsxs)(q.a.Cell,{width:"2",children:["$",e.price]}),Object(k.jsx)(q.a.Cell,{width:"3",children:e.description}),Object(k.jsxs)(q.a.Cell,{width:"1",children:[Object(k.jsx)(z.a,{icon:"remove",loading:t,disabled:t,onClick:function(){s(e.id),p(e.id)}}),Object(k.jsx)(z.a,{icon:"edit",onClick:function(){j.push("/manage/".concat(e.id))}})]})]},e.id)}))}),Object(k.jsx)(q.a.Footer,{children:Object(k.jsx)(q.a.Row,{children:Object(k.jsx)(q.a.HeaderCell,{colSpan:"4",children:Object(k.jsxs)(A.a,{floated:"right",pagination:!0,children:[Object(k.jsx)(A.a.Item,{icon:!0,as:i.b,to:"/products?page=".concat(Math.max(1,t-1)),disabled:1===t,children:Object(k.jsx)(E.a,{name:"chevron left"})}),Object(T.a)(new Array(n)).map((function(e,n){return Object(k.jsx)(A.a.Item,{as:i.b,to:"/products?page=".concat(n+1),disabled:n+1===t,children:n+1},n)})),Object(k.jsx)(A.a.Item,{icon:!0,as:i.b,to:"/products?page=".concat(Math.min(n,t+1)),disabled:t===n,children:Object(k.jsx)(E.a,{name:"chevron right"})})]})})})})]})})),M=Object(I.a)((function(){var e=w().productStore,t=e.amount,n=e.loadingInitial,c=e.loadProducts,a=new URLSearchParams(Object(y.g)().search),i=Object(y.g)(),o=a.has("page")?Number(a.get("page")):1,s=a.has("pageSize")?Number(a.get("pageSize")):5,u=Math.ceil(t/s);return Object(r.useEffect)((function(){c(o,s)}),[o,s,i.key,c]),n?Object(k.jsx)(N,{label:"Loading products..."}):Object(k.jsx)("div",{children:0===t?Object(k.jsx)("div",{children:"No products avaliable"}):Object(k.jsx)(F,{page:o,totalPages:u})})})),B=n(103),D=n(114),V=n(406),J=n(116),K=n(403),U=n(148),W=function(e){var t=e.placeholder,n=e.name,r=e.label,c=e.type,a=void 0===c?"text":c,i=Object(D.c)(n),o=Object(H.a)(i,2),s=o[0],u=o[1];return Object(k.jsxs)(K.a.Field,{error:u.touched&&!!u.error,children:[Object(k.jsx)("label",{children:r}),Object(k.jsx)("input",Object(B.a)(Object(B.a)({},s),{},{type:a,placeholder:t})),u.touched&&u.error?Object(k.jsx)(U.a,{color:"red",basic:!0,children:u.error}):null]})},Q=n(217),$=n.n(Q),G={id:"",title:"",price:10,description:""},X=J.b({title:J.c().required("The product title is required"),price:J.a().positive("The product price must be greater than zero").required("The product price is required"),description:J.c().required("The product price is required")}),Y=Object(I.a)((function(){var e=Object(r.useState)(G),t=Object(H.a)(e,2),n=t[0],c=t[1],a=Object(y.f)(),o=Object(y.h)().id,s=w().productStore,u=s.loadingInitial,d=s.loadProduct,l=s.createProduct,p=s.updateProduct;Object(r.useEffect)((function(){o&&d(o).then((function(e){return c({id:e.id,title:e.title,price:e.price,description:e.description})})).catch((function(e){console.log("Can`t load product",e),a.push("/notfound")}))}),[o,d,a]);return u?Object(k.jsx)(N,{label:"Loading product"}):Object(k.jsx)("div",{className:$.a.form,children:Object(k.jsx)(D.b,{enableReinitialize:!0,initialValues:n,validationSchema:X,onSubmit:function(e){return function(e){if(e.id)p(e).then((function(){a.push("/products")}));else{var t=Object(B.a)(Object(B.a)({},e),{},{id:Object(V.a)()});l(t).then((function(){a.push("/products")}))}}(e)},children:function(e){var t=e.isSubmitting,n=e.isValid,r=e.dirty,c=e.handleSubmit;return Object(k.jsxs)(D.a,{className:"ui form",autoComplete:"off",onSubmit:c,children:[Object(k.jsx)(W,{name:"title",label:"Title",placeholder:"Product Title"}),Object(k.jsx)(W,{name:"price",label:"Price",placeholder:"Product Price",type:"number"}),Object(k.jsx)(W,{name:"description",label:"Description",placeholder:"Product Description"}),Object(k.jsx)(z.a,{type:"submit",content:"Submit",floated:"right",positive:!0,loading:t,disabled:t||!n||!r}),Object(k.jsx)(z.a,{as:i.b,to:"/products",type:"button",content:"Cancel",floated:"right"})]})}})})})),Z=function(){return Object(k.jsx)("div",{children:Object(k.jsx)(A.a,{color:"blue",children:Object(k.jsxs)(P.a,{children:[Object(k.jsx)(A.a.Item,{as:i.c,to:"/",name:"Home",exact:!0}),Object(k.jsx)(A.a.Item,{as:i.c,to:"/products",name:"Products"})]})})})},ee=n(218),te=n.n(ee),ne=function(){var e=Object(y.g)();return Object(k.jsx)("div",{className:te.a.app,children:Object(k.jsxs)(P.a,{children:[Object(k.jsx)(Z,{}),Object(k.jsxs)(y.c,{children:[Object(k.jsx)(y.a,{path:"/",component:C,exact:!0}),Object(k.jsx)(y.a,{path:"/products",component:M}),Object(k.jsx)(y.a,{path:["/createProduct","/manage/:id"],component:Y},e.key),Object(k.jsx)(y.a,{component:S})]})]})})};n(388);a.a.render(Object(k.jsx)(v.Provider,{value:m,children:Object(k.jsx)(i.a,{children:Object(k.jsx)(ne,{})})}),document.getElementById("root"))}},[[389,1,2]]]);
//# sourceMappingURL=main.33b36a8e.chunk.js.map